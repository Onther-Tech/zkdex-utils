# zkdex-utils
zkdex-utils is a utility library for zk-dex

# Spec

- Account : https://github.com/Onther-Tech/ZKDIPs/blob/master/ZKDIPs/zkdip-2.md

# Install
```
$ npm install zkdex-utils
```

# Usage

## Account
```javascript
const { Account } = require('zkdex-utils');

//Get random Account
let account = Account.createRandom();
console.log(account.dump());
// { sk: '283730080929924873539930417380046991915',
//   pubkey:
//    { x: '8134376785179039193608734207041942142438070292053423243321516244844882635788',
//      y: '16644628734174215692352200865591121051826568248988524186501560699726127215679' },
//   pubkeyHexstring: '11fbe4e409340feb598b9ba8057c50222367573f7e03d5d390244198c99f2c0c24cc86a8c45f16060a2b7ec6aa0917ccb69238f1485e2e5f7955447b646cb43f',
//   digestedPubkey: 'fc6227abd30e809e1fa66898c85a67c6508b15bde961656da11b0f27821fadd1',
//   zkAddressBase58: '3ntnZBQPzVwMosKct6MSPX9opVrG',
//   zkAddressFormat: 'zk3ntnZBQPzVwMosKct6MSPX9opVrG',
//   zkAddress: 'c85a67c6508b15bde961656da11b0f27821fadd1' }

//Create account based on sk = '20778773223370278579726443807976762714'
let account2 = Account.create('20778773223370278579726443807976762714');
console.log(account2.dump());
```

## Note
```javascript
const { Note } = require('../src/Note.js');

const OWNER = "53d1cadfe54ffd6b81d45c9917325c2fec23861ff5ed4ea51641d6bb883978b0";
const VALUE = '6';
const TYPE = '0';
const VIEW_KEY='1aba488300a9d7297a315d127837be4219107c62c61966ecdf7a75431d75cc61';
const SALT = 'c517f646255d5492089b881965cbd3da';

const DUMMY_ACCCOUNT = {
  sk: '23308570483326979346009455655324790223',
  pubkey:
   { x:
      '21669759072347788482381813644067457741730356871300221121818333104179411783379',
     y:
      '11774563644740807655196226977456003496673702937851408230040213437235587979398' },
  pubkeyHexstring:
   '2fe8a62459c57cee2e9f00bbc7b5c8ec8c0251eafafcac97f61a739b33318ed31a082ab6ed6591754967a86e847c863e5a3468c7358b1b484568b9f12c701886',
  digestedPubkey:
   '53d1cadfe54ffd6b81d45c9917325c2fec23861ff5ed4ea51641d6bb883978b0',
  zkAddressBase58: 'Kk9CwQ6gzbogX4rzWZjxA6esqXd',
  zkAddressFormat: 'zkKk9CwQ6gzbogX4rzWZjxA6esqXd',
  zkAddress: '17325c2fec23861ff5ed4ea51641d6bb883978b0'
};

let note = new Note(OWNER, VALUE, TYPE, VIEW_KEY, SALT);


note.getNoteHash();
//return : '0b978ec7750e70c76c95ffd631cc705db0e5b35496dea5e6e6b0c677ea8e310d'

note.getNoteRaw();
//Return : '53d1cadfe54ffd6b81d45c9917325c2fec23861ff5ed4ea51641d6bb883978b00000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000001aba488300a9d7297a315d127837be4219107c62c61966ecdf7a75431d75cc61c517f646255d5492089b881965cbd3da'

let encData = note.encrypt("abc");
//Return : '0x3235785156466c533848664463474656684b665542486a375076376b646d416b654152626851644f2b2b456472792f536c476e724c4562446e4a72456b3054364f56746f69596c634f6b64326142634a4a4b2b2f546e4844773867556b59384754723063425a7769586139306d787562744a4c543171435557582b4132524e433445356a6f4a466c384a66744d574851554538556462754b42776c5145486b486a7962304851347954395a525a512b674a4b37675568515571615849644f3374676e4765456a7875764b4643465938344f586e42707976776671774f62377748744c66572b6d6b6c513676754e70522b353753664e5a4949307a5638416758476c304c34585675634c4749487066545063585a364158636a5464726a70397053544f345375532f5967634c6a546b3137362b6c2b396f326c46755855376b394451664d41756965514843702b3977692f6f4a57664e66776b517a5553716c306c375971707166545a4b4f6a566d625a316335556c6b613045537a504a69466d56486142512f4d304d70305378455257525a765154493541735a6a69565544624e69444c654f6879547766673d'

let decNote = Note.decrypt(encData, "abc");
// Return :
// Note {
//   owner:
//    '53d1cadfe54ffd6b81d45c9917325c2fec23861ff5ed4ea51641d6bb883978b0',
//   value:
//    '0000000000000000000000000000000000000000000000000000000000000006',
//   type: '00000000000000000000000000000000',
//   viewKey:
//    '0000000000000000000000000000000000000000000000000000000000000001',
//   salt: 'c517f646255d5492089b881965cbd3da' }

note.isSmart();
//Return : False

note.isOwnedBy(DUMMY_ACCOUNT.sk);
//Return : False

note.isNoteHash(NOTE_HASH);
//Return : True

JSON.parse(note.toString());
//Return :
//{"owner":"53d1cadfe54ffd6b81d45c9917325c2fec23861ff5ed4ea51641d6bb883978b0","value":"0000000000000000000000000000000000000000000000000000000000000006","type":"00000000000000000000000000000000","viewKey":"1aba488300a9d7297a315d127837be4219107c62c61966ecdf7a75431d75cc61","salt":"c517f646255d5492089b881965cbd3da"}

note.getNoteParamsPadded()
//[Owner, Value, Type, viewKey, salt], left 0 padded
//Return :
// [ '53d1cadfe54ffd6b81d45c9917325c2fec23861ff5ed4ea51641d6bb883978b0',
//   '0000000000000000000000000000000000000000000000000000000000000006',
//   '00000000000000000000000000000000',
//   '1aba488300a9d7297a315d127837be4219107c62c61966ecdf7a75431d75cc61',
//   'c517f646255d5492089b881965cbd3da' ]

note.getNoteParamsForCircuit();
// [owner1, owner2, value1, value2, type, viewKey1, viewKey2, salt]
// Return :
// [ '53d1cadfe54ffd6b81d45c9917325c2f',
//   'ec23861ff5ed4ea51641d6bb883978b0',
//   '00000000000000000000000000000000',
//   '00000000000000000000000000000006',
//   '00000000000000000000000000000000',
//   '1aba488300a9d7297a315d127837be42',
//   '19107c62c61966ecdf7a75431d75cc61',
//   'c517f646255d5492089b881965cbd3da' ]

```

## utils
```javascript
const { utils } = require('zkdex-utils');

let hexValue = 'd16501b93aacfb4cb52413d87646f9ec45ecae7a';
let intValue = '1195431596509751261413288945812563671344183291514';

utils.hexToInt(hexValue);
//return : '1195431596509751261413288945812563671344183291514'

utils.pad0andSplit(hexValue);
//return :
//[ '000000000000000000000000d16501b9',
//  '3aacfb4cb52413d87646f9ec45ecae7a' ]

utils.pad0andSplit(hexValue);
//return : [ '3513057721', '77993395777404380459046375406321839738' ]

utils.toHashed(hexValue);
//return : 'ccb2f234308cae2c01e2277785da7ea320d5bab2c363e09a18aaeb7f5221a689'

utils.toIntHashed(hexValue);
//return : '92587991518162908190149129956315054014557365764270414047919968238243684656777'

utils.toSplittedHashed(hexValue);
//return :
//[ 'ccb2f234308cae2c01e2277785da7ea3',
//  '20d5bab2c363e09a18aaeb7f5221a689' ]

utils.toSplittedIntHashed(hexValue);
//return :
//[ '272091652458955924425974303020698730147',
//  '43645041787254754191522146263106692745' ]

utils.intToHex(intValue);
//return : '1195431596509751261413288945812563671344183291514'

utils.zComputeWitnessCommand(['a','b','c']);
//return : './zokrates compute-witness -a 10 11 12'

utils.encodeBase58('3c69e1b7c4a462c78f1c69d9dfdb866439f6c401');
//return : 'qpMYvgboxV2bP6P3nDu1JTekjaQ'

utils.decodeBase58('qpMYvgboxV2bP6P3nDu1JTekjaQ');
//return : '3c69e1b7c4a462c78f1c69d9dfdb866439f6c401'

utils.formatToAddress('zkqpMYvgboxV2bP6P3nDu1JTekjaQ');
//return : '3c69e1b7c4a462c78f1c69d9dfdb866439f6c401'

utils.addressToFormat('3c69e1b7c4a462c78f1c69d9dfdb866439f6c401');
//return : 'zkqpMYvgboxV2bP6P3nDu1JTekjaQ'
```
